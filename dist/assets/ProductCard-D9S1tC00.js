import{j as s,J as C,B as k,w as A,x as $,y as T}from"./ui-vendor-BbdbCsUZ.js";import{a as f}from"./react-vendor-DTdTrAaS.js";import{B as d}from"./button-DV96QXU2.js";import{a as E,g as i,b as j,J as c}from"./index-CU51xw2J.js";import{L as g}from"./router-vendor-Dt4hhyuR.js";const _=({product:e})=>{const{state:p,dispatch:x}=E(),[n,h]=f.useState(!1),[a,y]=f.useState(!1),r=e.stock_status==="instock"||e.inStock!==!1,m=p.items.find(t=>t.id===e.id),l=!!m,o=(m==null?void 0:m.quantity)||0,b=e.originalPrice&&e.originalPrice>e.price?Math.round((e.originalPrice-e.price)/e.originalPrice*100):0,u=()=>{if(!r){c.error("Prodotto non disponibile");return}x({type:"ADD_ITEM",payload:{id:e.id,name:e.name,price:e.price,image:e.image,category:e.category}}),c.success(`${e.name} aggiunto al carrello!`,{icon:s.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:i(e.category)},children:"✓"}),style:{border:`2px solid ${i(e.category)}`}})},w=()=>{if(!a&&!l){y(!0);return}l||u()},v=()=>{if(!r)return;x({type:"ADD_ITEM",payload:{id:e.id,name:e.name,price:e.price,image:e.image,category:e.category}});const t=l?`Quantità aggiornata: ${o+1}x ${e.name}`:`${e.name} aggiunto al carrello!`;c.success(t,{icon:s.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:i(e.category)},children:"✓"}),style:{border:`2px solid ${i(e.category)}`}})},N=()=>{o>1?(x({type:"UPDATE_QUANTITY",payload:{id:e.id,quantity:o-1}}),c.success(`Quantità aggiornata: ${o-1}x ${e.name}`,{icon:s.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:i(e.category)},children:"✓"}),style:{border:`2px solid ${i(e.category)}`}})):(x({type:"REMOVE_ITEM",payload:e.id}),c.success(`${e.name} rimosso dal carrello`,{icon:s.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:"#A11E26"},children:"✓"}),style:{border:"2px solid #A11E26",backgroundColor:"#A11E26",color:"white"}}))};return s.jsxs("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 group relative overflow-hidden border-2",style:{borderColor:i(e.category)},onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),onTouchStart:()=>y(!0),children:[b>0&&s.jsxs("div",{className:"absolute top-1 left-1 bg-red-500 text-white px-1.5 py-0.5 rounded text-xs font-bold z-10",children:["-",b,"%"]}),(e.bottleQuantity||j(e.short_description||e.description))&&s.jsxs("div",{className:"absolute top-2 -right-8 text-white px-8 py-1 text-xs font-bold z-10 flex items-center gap-1 transform rotate-45",style:{backgroundColor:i(e.category)},children:["x",e.bottleQuantity||j(e.short_description||e.description)," bott."]}),l&&!n&&!a&&s.jsxs("div",{className:"absolute bottom-12 sm:bottom-20 left-1/2 -translate-x-1/2 text-white px-1.5 py-0.5 rounded text-xs font-bold z-10 flex items-center gap-1 whitespace-nowrap",style:{backgroundColor:"#A40800"},children:[s.jsx(C,{className:"w-3 h-3"}),"Nel carrello (",o,")"]}),s.jsxs("div",{className:"relative h-40 sm:h-48 md:h-56 overflow-hidden bg-gray-50",children:[s.jsx(g,{to:`/prodotti/${e.slug||e.id}`,children:s.jsx("img",{src:e.image,alt:e.name,className:"w-full h-full object-contain group-hover:scale-105 transition-transform duration-300 p-2",onError:t=>{t.currentTarget.src="/placeholder.svg"}})}),s.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 flex flex-col items-center justify-center gap-3 sm:gap-2",children:[l?s.jsxs("div",{className:`${n||a?"opacity-100":"opacity-0"} transition-all duration-300 transform ${n||a?"translate-y-0":"translate-y-4"} flex items-center gap-2`,children:[s.jsx(d,{onClick:N,className:"text-white px-2 py-1 text-xs bg-red-600 hover:bg-red-700 min-w-[40px] sm:min-w-[32px] h-10 sm:h-8",children:s.jsx(A,{className:"w-4 h-4 sm:w-3 sm:h-3"})}),s.jsx("span",{className:"text-white font-bold text-sm bg-black bg-opacity-50 px-3 py-1 rounded min-w-[50px] sm:min-w-[40px] text-center",children:o}),s.jsx(d,{onClick:v,disabled:!r,className:"text-white px-2 py-1 text-xs bg-green-600 hover:bg-green-700 min-w-[40px] sm:min-w-[32px] h-10 sm:h-8",children:s.jsx($,{className:"w-4 h-4 sm:w-3 sm:h-3"})})]}):s.jsxs(d,{onClick:w,disabled:!r,className:`${n||a?"opacity-100":"opacity-0"} transition-all duration-300 transform ${n||a?"translate-y-0":"translate-y-4"} text-white px-2 py-1 text-xs bg-gray-800 hover:bg-gray-900`,children:[s.jsx(k,{className:"w-3 h-3 mr-1"}),r?"Aggiungi":"Non Disponibile"]}),l&&s.jsx("div",{className:"mt-2",children:s.jsx(g,{to:"/cart",children:s.jsxs(d,{className:`${n||a?"opacity-100":"opacity-0"} transition-all duration-300 transform ${n||a?"translate-y-0":"translate-y-4"} text-white px-2 py-1 text-xs`,style:{backgroundColor:"#1B5AAB"},onMouseEnter:t=>t.currentTarget.style.backgroundColor="#154a9a",onMouseLeave:t=>t.currentTarget.style.backgroundColor="#1B5AAB",children:[s.jsx(T,{className:"w-3 h-3 mr-1"}),"Vai al Carrello"]})})})]})]}),s.jsxs("div",{className:"p-2",children:[s.jsx(g,{to:`/prodotti/${e.slug||e.id}`,children:s.jsx("h3",{className:"font-bold mb-1 text-xs sm:text-sm line-clamp-2 hover:opacity-80 transition-colors",style:{color:"#1B5AAB"},children:e.name})}),s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex flex-col",children:[e.originalPrice&&s.jsxs("span",{className:"text-xs text-gray-500 line-through",children:[e.originalPrice.toFixed(2),"€"]}),s.jsxs("span",{className:"font-bold text-sm",style:{color:"#A40800"},children:[e.price.toFixed(2),"€"]})]})})]})]})};export{_ as P};
