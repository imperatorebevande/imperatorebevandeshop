import{j as e,$ as j,ac as _,r as z,M as R,ae as v,a2 as y,s as B,t as q}from"./ui-vendor-CBu0MraC.js";import{r as n}from"./react-vendor-DTdTrAaS.js";import{u as M,w as g,J as m}from"./index-I5fS8uHh.js";import{C as D,b as k,c as O,d as H,a as J}from"./card-CJGvcwoN.js";import{I as l,B as C}from"./input-BrCX-FV-.js";import{L as i}from"./label-BP42n_nh.js";import{A as U,a as $}from"./alert-cqSDNtBl.js";const Z=({onSuccess:d,onSwitchToLogin:o})=>{const[s,w]=n.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",phone:"",address:"",city:"",postalCode:"",province:""}),[f,N]=n.useState(!1),[p,r]=n.useState(""),[h,b]=n.useState(!1),[u,A]=n.useState(!1),{setUser:P}=M(),t=x=>{const{name:c,value:a}=x.target;w(I=>({...I,[c]:a})),p&&r("")},F=()=>s.firstName.trim()?s.lastName.trim()?s.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)?s.password?s.password.length<6?(r("La password deve essere di almeno 6 caratteri"),!1):s.password!==s.confirmPassword?(r("Le password non coincidono"),!1):!0:(r("La password è obbligatoria"),!1):(r("Inserisci un indirizzo email valido"),!1):(r("L'email è obbligatoria"),!1):(r("Il cognome è obbligatorio"),!1):(r("Il nome è obbligatorio"),!1),E=async x=>{if(x.preventDefault(),!!F()){N(!0),r("");try{const c=await g.createCustomer({email:s.email,first_name:s.firstName,last_name:s.lastName,password:s.password,billing:{first_name:s.firstName,last_name:s.lastName,email:s.email,phone:s.phone,address_1:s.address,city:s.city,postcode:s.postalCode,state:s.province,country:"IT"},shipping:{first_name:s.firstName,last_name:s.lastName,address_1:s.address,city:s.city,postcode:s.postalCode,state:s.province,country:"IT"}});m.success("Account creato con successo!");try{const a=await g.loginWithCredential(s.email,"email");a.success&&a.customer?(P({id:a.customer.id,email:a.customer.email,firstName:a.customer.first_name,lastName:a.customer.last_name,username:a.customer.username,billing:a.customer.billing,shipping:a.customer.shipping}),m.success("Accesso effettuato automaticamente!"),d==null||d()):(m.success("Account creato! Ora puoi effettuare l'accesso."),o==null||o())}catch(a){console.error("Errore nel login automatico:",a),m.success("Account creato! Ora puoi effettuare l'accesso."),o==null||o()}}catch(c){console.error("Errore nella registrazione:",c),r(c.message||"Errore durante la registrazione. Riprova."),m.error("Errore durante la registrazione")}finally{N(!1)}}};return e.jsxs(D,{className:"w-full max-w-md mx-auto",children:[e.jsxs(k,{className:"space-y-1",children:[e.jsx(O,{className:"text-2xl font-bold text-center text-[#1B5AAB]",children:"Crea Account"}),e.jsx(H,{className:"text-center",children:"Registrati per iniziare a fare acquisti"})]}),e.jsx(J,{children:e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"firstName",children:"Nome *"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(l,{id:"firstName",name:"firstName",type:"text",placeholder:"Mario",value:s.firstName,onChange:t,className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"lastName",children:"Cognome *"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(l,{id:"lastName",name:"lastName",type:"text",placeholder:"Rossi",value:s.lastName,onChange:t,className:"pl-10",required:!0})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"email",children:"Email *"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(l,{id:"email",name:"email",type:"email",placeholder:"mario.rossi@email.com",value:s.email,onChange:t,className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"phone",children:"Telefono"}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(l,{id:"phone",name:"phone",type:"tel",placeholder:"+39 123 456 7890",value:s.phone,onChange:t,className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"address",children:"Indirizzo"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(l,{id:"address",name:"address",type:"text",placeholder:"Via Roma 123",value:s.address,onChange:t,className:"pl-10"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"city",children:"Città"}),e.jsx(l,{id:"city",name:"city",type:"text",placeholder:"Milano",value:s.city,onChange:t})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"postalCode",children:"CAP"}),e.jsx(l,{id:"postalCode",name:"postalCode",type:"text",placeholder:"20100",value:s.postalCode,onChange:t})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"province",children:"Provincia"}),e.jsx(l,{id:"province",name:"province",type:"text",placeholder:"MI",value:s.province,onChange:t})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"password",children:"Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{id:"password",name:"password",type:h?"text":"password",placeholder:"Almeno 6 caratteri",value:s.password,onChange:t,className:"pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>b(!h),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:h?e.jsx(v,{className:"h-4 w-4"}):e.jsx(y,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"confirmPassword",children:"Conferma Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx(l,{id:"confirmPassword",name:"confirmPassword",type:u?"text":"password",placeholder:"Ripeti la password",value:s.confirmPassword,onChange:t,className:"pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>A(!u),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:u?e.jsx(v,{className:"h-4 w-4"}):e.jsx(y,{className:"h-4 w-4"})})]})]}),p&&e.jsx(U,{variant:"destructive",children:e.jsx($,{children:p})}),e.jsx(C,{type:"submit",className:"w-full bg-[#1B5AAB] hover:bg-[#164A9A]",disabled:f,children:f?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mr-2 h-4 w-4 animate-spin"}),"Creazione account..."]}):"Crea Account"}),o&&e.jsx("div",{className:"text-center",children:e.jsxs(C,{type:"button",variant:"ghost",onClick:o,className:"text-[#1B5AAB] hover:text-[#164A9A]",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Hai già un account? Accedi"]})})]})})]})};export{Z as R};
