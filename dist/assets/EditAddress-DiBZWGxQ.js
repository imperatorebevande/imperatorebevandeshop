import{j as s,Q as S}from"./ui-vendor-BbdbCsUZ.js";import{r as k}from"./react-vendor-DTdTrAaS.js";import{B as C}from"./button-DV96QXU2.js";import{I as a}from"./input-BScXBkmv.js";import{L as r}from"./label-CwSIXhkn.js";import{f as w}from"./useWooCommerce-BVF7l480.js";import{A as q}from"./AddressAutocomplete-YnZsXfoI.js";const M=({customer:t,onClose:c})=>{const[i,p]=k.useState({shipping:{...t.shipping,first_name:t.shipping.first_name||t.first_name,last_name:t.shipping.last_name||t.last_name,address_1:t.shipping.address_1||"",city:t.shipping.city||"",state:t.shipping.state||"",postcode:t.shipping.postcode||"",country:t.shipping.country||"IT"},billing:{...t.billing,address_1:t.billing.address_1||"",city:t.billing.city||"",state:t.billing.state||"",postcode:t.billing.postcode||"",country:t.billing.country||"IT"}}),m=w(),n=(e,o)=>{const{name:d,value:l}=e.target;p({...i,[o]:{...i[o],[d]:l}})},F=e=>{var l,g,x,A,B,b,u,_,f,y,j,v,N;e.preventDefault();const o=h=>{const I=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return h&&h.trim()&&I.test(h.trim())},d={shipping:{first_name:((l=i.shipping.first_name)==null?void 0:l.trim())||"",last_name:((g=i.shipping.last_name)==null?void 0:g.trim())||"",company:i.shipping.company||"",address_1:((x=i.shipping.address_1)==null?void 0:x.trim())||"",address_2:i.shipping.address_2||"",city:((A=i.shipping.city)==null?void 0:A.trim())||"",state:((B=i.shipping.state)==null?void 0:B.trim())||"",postcode:((b=i.shipping.postcode)==null?void 0:b.trim())||"",country:i.shipping.country||"IT"},billing:{first_name:((u=i.shipping.first_name)==null?void 0:u.trim())||"",last_name:((_=i.shipping.last_name)==null?void 0:_.trim())||"",company:i.billing.company||"",address_1:((f=i.shipping.address_1)==null?void 0:f.trim())||"",address_2:i.billing.address_2||"",city:((y=i.shipping.city)==null?void 0:y.trim())||"",state:((j=i.shipping.state)==null?void 0:j.trim())||"",postcode:((v=i.shipping.postcode)==null?void 0:v.trim())||"",country:i.shipping.country||"IT",phone:((N=t.billing)==null?void 0:N.phone)||""}};o(t.email)&&(d.billing.email=t.email.trim()),console.log("Dati puliti da inviare:",d),m.mutate({id:t.id,customerData:d},{onSuccess:()=>{console.log("Chiusura del dialogo in corso..."),c()}})};return s.jsxs("form",{onSubmit:F,className:"space-y-2 sm:space-y-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("div",{children:[s.jsx(r,{htmlFor:"shipping_first_name",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Nome"}),s.jsx(a,{id:"shipping_first_name",name:"first_name",value:i.shipping.first_name,onChange:e=>n(e,"shipping"),className:"h-8 sm:h-9 focus:ring-[#1B5AAB] rounded-md text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-sm border-gray-300 focus:border-[#1B5AAB]",required:!0})]}),s.jsxs("div",{children:[s.jsx(r,{htmlFor:"shipping_last_name",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Cognome"}),s.jsx(a,{id:"shipping_last_name",name:"last_name",value:i.shipping.last_name,onChange:e=>n(e,"shipping"),className:"h-8 sm:h-9 focus:ring-[#1B5AAB] rounded-md text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-sm border-gray-300 focus:border-[#1B5AAB]",required:!0})]})]}),s.jsx("div",{children:s.jsx(q,{label:"Indirizzo",placeholder:"Inizia a digitare l'indirizzo...",value:i.shipping.address_1,onChange:e=>{p({...i,shipping:{...i.shipping,address_1:e}})},onAddressSelect:e=>{p({...i,shipping:{...i.shipping,address_1:e.address,city:e.city,state:e.province,postcode:e.postalCode}})},required:!0})}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("div",{children:[s.jsx(r,{htmlFor:"shipping_city",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"CittÃ  *"}),s.jsx(a,{id:"shipping_city",name:"city",value:i.shipping.city,onChange:e=>n(e,"shipping"),className:"h-8 sm:h-9 focus:ring-[#1B5AAB] rounded-md text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-sm border-gray-300 focus:border-[#1B5AAB]",required:!0})]}),s.jsxs("div",{children:[s.jsx(r,{htmlFor:"shipping_state",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Provincia *"}),s.jsx(a,{id:"shipping_state",name:"state",value:i.shipping.state,onChange:e=>n(e,"shipping"),className:"h-8 sm:h-9 focus:ring-[#1B5AAB] rounded-md text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-sm border-gray-300 focus:border-[#1B5AAB]",required:!0})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[s.jsxs("div",{children:[s.jsx(r,{htmlFor:"shipping_postcode",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"CAP *"}),s.jsx(a,{id:"shipping_postcode",name:"postcode",value:i.shipping.postcode,onChange:e=>n(e,"shipping"),className:"h-8 sm:h-9 focus:ring-[#1B5AAB] rounded-md text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-sm border-gray-300 focus:border-[#1B5AAB]",required:!0})]}),s.jsxs("div",{children:[s.jsx(r,{htmlFor:"shipping_country",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Paese"}),s.jsx(a,{id:"shipping_country",name:"country",value:i.shipping.country,onChange:e=>n(e,"shipping"),className:"h-8 sm:h-9 bg-gray-50 border-gray-200 text-gray-500 rounded-md text-sm",readOnly:!0})]})]})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsx(C,{type:"button",variant:"outline",onClick:c,className:"flex-1 h-8 sm:h-9 border-2 border-gray-300 text-gray-700 hover:bg-[#A40800] hover:text-white hover:border-[#A40800] transition-all duration-200 rounded-md font-medium text-sm",children:"Annulla"}),s.jsx(C,{type:"submit",disabled:m.isPending,className:"flex-1 h-8 sm:h-9 bg-[#1B5AAB] hover:bg-[#164a94] text-white disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 rounded-md font-medium shadow-lg hover:shadow-xl text-sm",children:m.isPending?s.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s.jsx(S,{className:"w-3 h-3 sm:w-4 sm:h-4 animate-spin"}),s.jsx("span",{className:"hidden sm:inline",children:"Salvando..."}),s.jsx("span",{className:"sm:hidden",children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"hidden sm:inline",children:"Salva Modifiche"}),s.jsx("span",{className:"sm:hidden",children:"Salva"})]})})]})]})};export{M as E};
