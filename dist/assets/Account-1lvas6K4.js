import{j as e,Q as ee,_ as he,a5 as pe,M as L,K as Ue,a7 as We,a8 as Pe,a9 as xe,x as Re,$ as He,O as Ke,aa as Qe,ab as Ie}from"./ui-vendor-BbdbCsUZ.js";import{r as c}from"./react-vendor-DTdTrAaS.js";import{H as Ve}from"./Header-C9jOduFB.js";import{B as y}from"./button-DV96QXU2.js";import{C as A,b as C,c as z,a as B}from"./card-po8LLNoY.js";import{f as ke,g as Ge,e as Xe,b as Ye}from"./useWooCommerce-BVF7l480.js";import{u as es,J as h,w as ss}from"./index-CU51xw2J.js";import{D as K,a as Q,b as V,c as G,d as X}from"./dialog-rh9CTZ6-.js";import{I as p}from"./input-BScXBkmv.js";import{L as g}from"./label-CwSIXhkn.js";import{E as is}from"./EditAddress-DiBZWGxQ.js";import{B as as}from"./badge-Dt5wVqj5.js";import{S as ts}from"./separator-BXEYAIvQ.js";import{determineZoneFromAddress as Y,determineZoneFromCoordinates as ns}from"./deliveryZones-Dl4LSmEF.js";import{a as oe}from"./geocoding-Doow1civ.js";import ls from"./Login-CWD6OpgM.js";import{A as Se}from"./AddressAutocomplete-YnZsXfoI.js";import"./router-vendor-Dt4hhyuR.js";import"./query-vendor-CYSRxJYb.js";import"./chart-vendor-CC4yw7IZ.js";import"./utils-vendor-BbYF_8OW.js";import"./alert-BbkdLCMH.js";import"./Register-BJ4Ie7NL.js";const rs=({customer:i,onClose:v})=>{const[m,E]=c.useState({first_name:i.first_name,last_name:i.last_name,email:i.email,username:i.username,billing:{...i.billing,phone:i.billing.phone||""}}),I=ke(),o=S=>{const{name:M,value:F}=S.target;E(M==="phone"?{...m,billing:{...m.billing,phone:F}}:{...m,[M]:F})},$=S=>{S.preventDefault(),I.mutate({id:i.id,customerData:m},{onSuccess:()=>{console.log("Chiusura del dialogo in corso..."),v()}})};return e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"first_name",children:"Nome"}),e.jsx(p,{id:"first_name",name:"first_name",value:m.first_name,onChange:o,required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"last_name",children:"Cognome"}),e.jsx(p,{id:"last_name",name:"last_name",value:m.last_name,onChange:o,required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"email",children:"Email"}),e.jsx(p,{id:"email",name:"email",type:"email",value:m.email,onChange:o,required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"username",children:"Username"}),e.jsx(p,{id:"username",name:"username",value:m.username,onChange:o,required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"phone",children:"Telefono"}),e.jsx(p,{id:"phone",name:"phone",value:m.billing.phone,onChange:o})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(y,{type:"button",variant:"outline",onClick:v,children:"Annulla"}),e.jsx(y,{type:"submit",disabled:I.isPending,children:I.isPending?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-4 h-4 animate-spin mr-2"}),"Salvataggio..."]}):"Salva Modifiche"})]})]})},os=({order:i})=>{const v=o=>new Date(o).toLocaleDateString("it-IT",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),m=o=>`${parseFloat(o).toFixed(2)}€`,E=o=>{switch(o){case"completed":return"bg-green-100 text-green-800";case"processing":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"refunded":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},I=o=>{switch(o){case"completed":return"Completato";case"processing":return"In elaborazione";case"pending":return"In attesa";case"cancelled":return"Annullato";case"refunded":return"Rimborsato";default:return o}};return e.jsxs("div",{className:"space-y-6 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-[#1B5AAB]",children:["Ordine #",i.number]}),e.jsxs("p",{className:"text-gray-600",children:["Creato il ",v(i.date_created)]})]}),e.jsx(as,{className:E(i.status),children:I(i.status)})]}),e.jsxs(A,{children:[e.jsx(C,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),"Prodotti Ordinati"]})}),e.jsx(B,{children:e.jsx("div",{className:"space-y-4",children:i.line_items.map((o,$)=>e.jsxs("div",{className:"flex justify-between items-center p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[o.image&&e.jsx("img",{src:o.image.src,alt:o.name,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:o.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["SKU: ",o.sku]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Quantità: ",o.quantity]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold",children:m(o.total)}),e.jsxs("p",{className:"text-sm text-gray-600",children:[m((parseFloat(o.total)/o.quantity).toString())," cad."]})]})]},o.id))})})]}),e.jsxs(A,{children:[e.jsx(C,{children:e.jsx(z,{children:"Riepilogo Ordine"})}),e.jsx(B,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotale:"}),e.jsx("span",{children:m((parseFloat(i.total)-parseFloat(i.shipping_total)-parseFloat(i.total_tax)).toString())})]}),parseFloat(i.shipping_total)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Spedizione:"}),e.jsx("span",{children:m(i.shipping_total)})]}),parseFloat(i.total_tax)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tasse:"}),e.jsx("span",{children:m(i.total_tax)})]}),parseFloat(i.discount_total)>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Sconto:"}),e.jsxs("span",{children:["-",m(i.discount_total)]})]}),e.jsx(ts,{}),e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("span",{children:"Totale:"}),e.jsx("span",{children:m(i.total)})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(A,{children:[e.jsx(C,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Indirizzo di Fatturazione"]})}),e.jsx(B,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"font-semibold",children:[i.billing.first_name," ",i.billing.last_name]}),i.billing.company&&e.jsx("p",{children:i.billing.company}),e.jsx("p",{children:i.billing.address_1}),i.billing.address_2&&e.jsx("p",{children:i.billing.address_2}),e.jsxs("p",{children:[i.billing.postcode," ",i.billing.city]}),e.jsxs("p",{children:[i.billing.state,", ",i.billing.country]}),e.jsx("p",{className:"text-sm text-gray-600",children:i.billing.email}),i.billing.phone&&e.jsx("p",{className:"text-sm text-gray-600",children:i.billing.phone})]})})]}),e.jsxs(A,{children:[e.jsx(C,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"Indirizzo di Spedizione"]})}),e.jsx(B,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"font-semibold",children:[i.shipping.first_name," ",i.shipping.last_name]}),i.shipping.company&&e.jsx("p",{children:i.shipping.company}),e.jsx("p",{children:i.shipping.address_1}),i.shipping.address_2&&e.jsx("p",{children:i.shipping.address_2}),e.jsxs("p",{children:[i.shipping.postcode," ",i.shipping.city]}),e.jsxs("p",{children:[i.shipping.state,", ",i.shipping.country]})]})})]})]}),e.jsxs(A,{children:[e.jsx(C,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"w-5 h-5"}),"Informazioni Pagamento"]})}),e.jsx(B,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Metodo di Pagamento:"}),e.jsx("span",{className:"font-semibold",children:i.payment_method_title})]}),i.transaction_id&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ID Transazione:"}),e.jsx("span",{className:"font-mono text-sm",children:i.transaction_id})]}),i.date_paid&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Data Pagamento:"}),e.jsx("span",{children:v(i.date_paid)})]}),i.date_completed&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Data Completamento:"}),e.jsx("span",{children:v(i.date_completed)})]})]})})]}),i.customer_note&&e.jsxs(A,{children:[e.jsx(C,{children:e.jsx(z,{children:"Note del Cliente"})}),e.jsx(B,{children:e.jsx("p",{className:"text-gray-700",children:i.customer_note})})]})]})},ds=({customer:i})=>{var $,S,M,F,U,se,T,ie;const[v,m]=c.useState(null),[E,I]=c.useState(!0);if(c.useEffect(()=>{const f=async()=>{var N,ae,Z,te,W,ne,q,O;I(!0);try{const w={city:((N=i.shipping)==null?void 0:N.city)||((ae=i.billing)==null?void 0:ae.city)||"",province:((Z=i.shipping)==null?void 0:Z.state)||((te=i.billing)==null?void 0:te.state)||"",postalCode:((W=i.shipping)==null?void 0:W.postcode)||((ne=i.billing)==null?void 0:ne.postcode)||"",address:((q=i.shipping)==null?void 0:q.address_1)||((O=i.billing)==null?void 0:O.address_1)||""},n=`${w.address}, ${w.city}, ${w.province} ${w.postalCode}`;let j=Y(w);if(!j&&w.address&&w.city)try{const b=await oe(w);b&&(j=ns(b.lat,b.lng))}catch(b){console.warn("Errore nella geocodifica:",b)}m(j)}catch(w){console.error("Errore nella determinazione della zona:",w)}finally{I(!1)}};i!=null&&i.shipping||i!=null&&i.billing?f():I(!1)},[i]),E)return e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(ee,{className:"w-3 h-3 mr-2 animate-spin"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Determinazione zona..."})]});const o=`${(($=i.shipping)==null?void 0:$.address_1)||((S=i.billing)==null?void 0:S.address_1)}, ${((M=i.shipping)==null?void 0:M.city)||((F=i.billing)==null?void 0:F.city)}, ${((U=i.shipping)==null?void 0:U.state)||((se=i.billing)==null?void 0:se.state)} ${((T=i.shipping)==null?void 0:T.postcode)||((ie=i.billing)==null?void 0:ie.postcode)}`;return v?e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:v.color}}),e.jsx("span",{className:"text-xs font-medium",style:{color:v.color},children:v.name})]}):e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-2 bg-gray-400"}),e.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["Zona non identificata - Debug: ",o]})]})},Fs=()=>{var we,Ae,Ce,ze,Be,_e;const{authState:i,logout:v}=es(),[m,E]=c.useState("profile");c.useState(!1),c.useState(!1),c.useState(!1);const[I,o]=c.useState(!1),[$,S]=c.useState(!1),[M,F]=c.useState(!1),[U,se]=c.useState(null),[T,ie]=c.useState(!1),[f,N]=c.useState([]),[ae,Z]=c.useState(!1),[te,W]=c.useState(null),[ne,q]=c.useState(!1),[O,w]=c.useState(null),[n,j]=c.useState({title:"",address:"",city:"",province:"",postalCode:"",notes:""}),[b,ge]=c.useState({newPassword:"",confirmPassword:""}),[ue,je]=c.useState(!1),[de,Oe]=c.useState(!1),[ce,Ee]=c.useState(!1),[ve,fe]=c.useState(!1),le=(we=i==null?void 0:i.user)!=null&&we.id&&i.user.id>0?i.user.id:null,R=!le&&!!((Ae=i==null?void 0:i.user)!=null&&Ae.email)&&!T,{data:re,isLoading:J}=Ge(((Ce=i==null?void 0:i.user)==null?void 0:Ce.email)||"",{enabled:R&&!!(i!=null&&i.isAuthenticated)}),u=c.useMemo(()=>le||(re&&re.length>0?re[0].id:null),[le,re]),{data:l,isLoading:be,error:cs}=Xe(u||0,{enabled:!!u&&u>0&&!!(i!=null&&i.isAuthenticated)}),{data:D,isLoading:Fe,error:ms}=Ye(u||0,{per_page:5},{enabled:!!u&&u>0&&!!(i!=null&&i.isAuthenticated)}),H=ke();c.useEffect(()=>{(!R||R&&!J)&&ie(!0)},[R,J]);const De=async s=>await Promise.all(s.map(async r=>{const d=Y({city:r.city,province:r.province,postalCode:r.postalCode,coordinates:r.coordinates});return{...r,deliveryZone:d?{id:d.id,name:d.name,color:d.color}:null}}));c.useEffect(()=>{if(l&&l.meta_data){const s=l.meta_data.find(a=>a.key==="saved_addresses");if(s&&s.value)try{const a=JSON.parse(s.value);De(a).then(r=>{if(N(r),JSON.stringify(a)!==JSON.stringify(r)&&(console.log("Aggiornamento colori zone per indirizzi salvati"),u&&i.isAuthenticated&&l)){const t=((l==null?void 0:l.meta_data)||[]).filter(k=>k.key!=="saved_addresses");t.push({key:"saved_addresses",value:JSON.stringify(r)}),H.mutateAsync({id:u,customerData:{meta_data:t}}).catch(k=>{console.error("Errore nell'aggiornamento colori zone:",k)})}})}catch(a){console.error("Errore nel parsing degli indirizzi salvati:",a)}}},[l,u,i.isAuthenticated]);const $e=s=>{const{name:a,value:r}=s.target;j(d=>({...d,[a]:r}))},Me=async()=>{if(!n.address||!n.city||!n.province||!n.postalCode){h.error("Compila tutti i campi obbligatori");return}const s=await oe({address:n.address,city:n.city,province:n.province,postalCode:n.postalCode}),a=Y({city:n.city,province:n.province,postalCode:n.postalCode,coordinates:s?{lat:s.lat,lng:s.lng}:void 0}),r={id:Date.now(),title:n.title||`Indirizzo ${f.length+1}`,address:n.address,city:n.city,province:n.province,postalCode:n.postalCode,notes:n.notes,coordinates:s?{lat:s.lat,lng:s.lng}:void 0,deliveryZone:a?{id:a.id,name:a.name,color:a.color}:null};a?h.success(`Indirizzo assegnato alla ${a.name}`):h.warning("Zona di consegna non determinata automaticamente");const d=[...f,r];if(N(d),u&&i.isAuthenticated)try{await H.mutateAsync({id:u,customerData:{meta_data:[{key:"saved_addresses",value:JSON.stringify(d)}]}}),h.success("Indirizzo salvato con successo!"),Z(!1),j({title:"",address:"",city:"",province:"",postalCode:"",notes:""})}catch(t){console.error("Errore nel salvataggio dell'indirizzo:",t),h.error("Errore nel salvataggio dell'indirizzo")}},Ze=async s=>{const a=f.filter(r=>r.id!==s);if(N(a),u&&i.isAuthenticated)try{await H.mutateAsync({id:u,customerData:{meta_data:[{key:"saved_addresses",value:JSON.stringify(a)}]}}),h.success("Indirizzo eliminato con successo!")}catch(r){console.error("Errore nell'eliminazione dell'indirizzo:",r),h.error("Errore nell'eliminazione dell'indirizzo")}},qe=async(s,a)=>{let r={...a};if(a.city||a.province||a.postalCode||a.address){const t=f.find(k=>k.id===s);if(t){const k={address:a.address||t.address,city:a.city||t.city,province:a.province||t.province,postalCode:a.postalCode||t.postalCode},_=await oe(k),P=Y({...k,coordinates:_?{lat:_.lat,lng:_.lng}:void 0});r.deliveryZone=P?{id:P.id,name:P.name,color:P.color}:null,_&&(r.coordinates={lat:_.lat,lng:_.lng}),P?h.success(`Indirizzo aggiornato e assegnato alla ${P.name}`):h.warning("Zona di consegna non determinata per l'indirizzo aggiornato")}}const d=f.map(t=>t.id===s?{...t,...r}:t);if(N(d),u&&i.isAuthenticated&&l)try{const t=d.map(x=>({id:x.id,title:x.title||"",address:x.address||"",city:x.city||"",province:x.province||"",postalCode:x.postalCode||"",notes:x.notes||"",coordinates:x.coordinates||null,deliveryZone:x.deliveryZone||null})),_=((l==null?void 0:l.meta_data)||[]).filter(x=>x.key!=="saved_addresses"),P=JSON.stringify(t);JSON.parse(P),_.push({key:"saved_addresses",value:P}),await H.mutateAsync({id:u,customerData:{meta_data:_}}),h.success("Indirizzo aggiornato con successo!"),W(null)}catch(t){console.error("Errore nell'aggiornamento dell'indirizzo:",t),h.error("Errore nell'aggiornamento dell'indirizzo")}},ye=s=>{const{name:a,value:r}=s.target;ge(d=>({...d,[a]:r}))},Le=async()=>{if(!b.newPassword||!b.confirmPassword){h.error("Compila tutti i campi obbligatori");return}if(b.newPassword!==b.confirmPassword){h.error("Le password non coincidono");return}if(b.newPassword.length<6){h.error("La password deve essere di almeno 6 caratteri");return}je(!0);try{if(u&&i.isAuthenticated){const s=await ss.changePassword(u,b.newPassword);s.success?(h.success(s.message),ge({newPassword:"",confirmPassword:""})):h.error(s.message)}}catch(s){console.error("Errore nel cambio password:",s),h.error("Errore nell'invio della richiesta")}finally{je(!1)}};if(!i)return e.jsx("div",{className:"min-h-screen bg-gray-50 pb-16 md:pb-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Inizializzazione..."})]})});if(!i.isAuthenticated)return e.jsx(ls,{});if(J)return e.jsx("div",{className:"min-h-screen bg-gray-50 pb-16 md:pb-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Ricerca profilo cliente..."})]})});if(u&&be)return e.jsx("div",{className:"min-h-screen bg-gray-50 pb-16 md:pb-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Caricamento dati account..."})]})});if(!u&&T)return e.jsx("div",{className:"min-h-screen bg-gray-50 pb-16 md:pb-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Profilo Temporaneo"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Benvenuto, ",(ze=i.user)==null?void 0:ze.email]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Il tuo account non è ancora collegato a un profilo WooCommerce."}),e.jsx("button",{onClick:v,className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700",children:"Logout"})]})});if(!u&&!R)return e.jsx("div",{className:"min-h-screen bg-gray-50 pb-16 md:pb-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Profilo Non Trovato"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Benvenuto, ",(Be=i.user)==null?void 0:Be.email]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Non è possibile trovare il tuo profilo WooCommerce."}),e.jsx("button",{onClick:v,className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700",children:"Logout"})]})});if(!u&&T&&!J)return e.jsx("div",{className:"min-h-screen bg-gray-50 pb-16 md:pb-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Profilo Non Trovato"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Benvenuto, ",(_e=i.user)==null?void 0:_e.email]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Non è stato possibile trovare il tuo profilo WooCommerce."}),e.jsx("button",{onClick:v,className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700",children:"Logout"})]})});if(J||be)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:J?"Ricerca profilo cliente...":"Caricamento dati account..."})]})});const me=s=>new Date(s).toLocaleDateString("it-IT"),Ne=s=>`${parseFloat(s).toFixed(2)}€`,Te=()=>{v(),h.success("Logout effettuato con successo!")},Je=s=>{se(s),F(!0)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-16 md:pb-0",children:[e.jsx(Ve,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#1B5AAB]",children:"Il Mio Account"}),e.jsxs(y,{onClick:Te,style:{backgroundColor:"#A40800"},className:"text-white flex items-center gap-2 px-4 py-2 rounded-md hover:opacity-90",children:[e.jsx(We,{className:"w-4 h-4"}),"Logout"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-8 border-b",children:[{id:"profile",label:"Profilo",icon:pe},{id:"orders",label:"Ordini",icon:he},{id:"address",label:"Indirizzo",icon:L},{id:"settings",label:"Impostazioni",icon:Pe}].map(s=>{const a=s.icon;return e.jsxs("button",{onClick:()=>E(s.id),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg transition-colors ${m===s.id?"bg-[#1B5AAB] text-white border-b-2 border-[#1B5AAB]":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(a,{className:"w-4 h-4"}),s.label]},s.id)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[m==="profile"&&e.jsxs(A,{children:[e.jsx(C,{children:e.jsxs(z,{className:"flex items-center gap-2 text-[#1B5AAB]",children:[e.jsx(pe,{className:"w-5 h-5"}),"Informazioni Profilo"]})}),e.jsx(B,{children:l?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nome"}),e.jsx("p",{className:"text-lg",children:l.first_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Cognome"}),e.jsx("p",{className:"text-lg",children:l.last_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Email"}),e.jsx("p",{className:"text-lg",children:l.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Data registrazione"}),e.jsx("p",{className:"text-lg",children:me(l.date_created)})]})]}),e.jsx(y,{onClick:()=>o(!0),className:"mt-4",children:"Modifica Profilo"})]}):e.jsx("p",{children:"Caricamento dati profilo..."})})]}),m==="orders"&&e.jsxs(A,{children:[e.jsx(C,{children:e.jsxs(z,{className:"flex items-center gap-2 text-[#1B5AAB]",children:[e.jsx(he,{className:"w-5 h-5"}),"I Miei Ordini"]})}),e.jsx(B,{children:Fe?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ee,{className:"w-6 h-6 animate-spin"})}):D&&D.length>0?e.jsx("div",{className:"space-y-4",children:D.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>Je(s),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold",children:["Ordine #",s.number]}),e.jsx("p",{className:"text-sm text-gray-600",children:me(s.date_created)})]}),e.jsxs("div",{className:"text-right flex items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:Ne(s.total)}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="processing"?"bg-blue-100 text-blue-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status})]}),e.jsx(xe,{className:"w-4 h-4 text-gray-400"})]})]}),e.jsx("div",{className:"text-sm text-gray-600",children:s.line_items.map(a=>e.jsxs("div",{children:[a.name," x ",a.quantity]},a.id))})]},s.id))}):e.jsx("p",{className:"text-center py-8 text-gray-500",children:"Nessun ordine trovato"})})]}),m==="address"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsx(C,{children:e.jsxs(z,{className:"flex items-center gap-2 text-[#1B5AAB]",children:[e.jsx(L,{className:"w-5 h-5"}),"Indirizzo Principale"]})}),e.jsx(B,{children:l!=null&&l.shipping?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[l.shipping.first_name," ",l.shipping.last_name]}),e.jsx("p",{children:l.shipping.address_1}),e.jsxs("p",{children:[l.shipping.postcode," ",l.shipping.city]}),e.jsxs("p",{children:[l.shipping.state,", ",l.shipping.country]}),e.jsx(ds,{customer:l}),e.jsx(y,{onClick:()=>S(!0),className:"mt-4",children:"Modifica Indirizzo Principale"})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"Nessun indirizzo di spedizione configurato"}),e.jsx(y,{onClick:()=>S(!0),children:"Aggiungi Indirizzo Principale"})]})})]}),e.jsxs(A,{children:[e.jsx(C,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(z,{className:"flex items-center gap-2 text-[#1B5AAB]",children:[e.jsx(L,{className:"w-5 h-5"}),"Altri indirizzi di Consegna"]}),e.jsxs(y,{onClick:()=>Z(!0),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:[e.jsx(Re,{className:"w-4 h-4"}),"Aggiungi Indirizzo"]})]})}),e.jsx(B,{children:f.length>0?e.jsx("div",{className:"space-y-4",children:f.map(s=>{var a;return e.jsx("div",{className:"border-2 rounded-lg p-4",style:{borderColor:((a=s.deliveryZone)==null?void 0:a.color)||"#d1d5db"},children:te===s.id?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:`edit-title-${s.id}`,children:"Titolo"}),e.jsx(p,{id:`edit-title-${s.id}`,value:s.title,onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,title:r.target.value}:t);N(d)}})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:`edit-address-${s.id}`,children:"Indirizzo *"}),e.jsx(p,{id:`edit-address-${s.id}`,value:s.address,onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,address:r.target.value}:t);N(d)},required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:`edit-city-${s.id}`,children:"Città *"}),e.jsx(p,{id:`edit-city-${s.id}`,value:s.city,onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,city:r.target.value}:t);N(d)},placeholder:"Inserisci la città",required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:`edit-province-${s.id}`,children:"Provincia *"}),e.jsx(p,{id:`edit-province-${s.id}`,value:s.province,onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,province:r.target.value}:t);N(d)},placeholder:"Inserisci la provincia",required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:`edit-postal-${s.id}`,children:"CAP *"}),e.jsx(p,{id:`edit-postal-${s.id}`,value:s.postalCode,onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,postalCode:r.target.value}:t);N(d)},placeholder:"Inserisci il CAP",required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:`edit-notes-${s.id}`,children:"Note"}),e.jsx(p,{id:`edit-notes-${s.id}`,value:s.notes||"",onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,notes:r.target.value}:t);N(d)}})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:()=>qe(s.id,s),className:"bg-green-600 hover:bg-green-700",children:"Salva"}),e.jsx(y,{onClick:()=>W(null),variant:"outline",children:"Annulla"})]})]}):e.jsx("div",{children:e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("h3",{className:"font-semibold text-lg",children:s.title})}),e.jsx("p",{className:"text-gray-600",children:s.address}),e.jsxs("p",{className:"text-gray-600",children:[s.postalCode," ",s.city,", ",s.province]}),s.notes&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Note: ",s.notes]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{onClick:()=>{w(s),j({title:s.title,address:s.address,city:s.city,province:s.province,postalCode:s.postalCode,notes:s.notes||""}),q(!0)},variant:"outline",size:"sm",className:"flex items-center gap-1",children:[e.jsx(He,{className:"w-4 h-4"}),"Modifica"]}),e.jsxs(y,{onClick:()=>Ze(s.id),variant:"outline",size:"sm",className:"flex items-center gap-1 text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(Ke,{className:"w-4 h-4"}),"Elimina"]})]})]})})},s.id)})}):e.jsx("p",{className:"text-center py-8 text-gray-500",children:"Nessun indirizzo salvato"})})]})]}),m==="settings"&&e.jsxs(A,{children:[e.jsx(C,{children:e.jsxs(z,{className:"flex items-center gap-2 text-[#1B5AAB]",children:[e.jsx(Pe,{className:"w-5 h-5"}),"Impostazioni Account"]})}),e.jsx(B,{children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Qe,{className:"w-5 h-5 text-[#1B5AAB]"}),e.jsx("h3",{className:"text-lg font-semibold text-[#1B5AAB]",children:"Cambia Password"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"newPassword",className:"text-sm font-medium text-gray-700",children:"Nuova Password *"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(p,{id:"newPassword",name:"newPassword",type:de?"text":"password",value:b.newPassword,onChange:ye,placeholder:"Inserisci la nuova password (min. 6 caratteri)",className:"pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>Oe(!de),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:de?e.jsx(Ie,{className:"w-4 h-4"}):e.jsx(xe,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"confirmPassword",className:"text-sm font-medium text-gray-700",children:"Conferma Nuova Password *"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(p,{id:"confirmPassword",name:"confirmPassword",type:ce?"text":"password",value:b.confirmPassword,onChange:ye,placeholder:"Conferma la nuova password",className:"pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>Ee(!ce),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:ce?e.jsx(Ie,{className:"w-4 h-4"}):e.jsx(xe,{className:"w-4 h-4"})})]})]}),e.jsx(y,{onClick:Le,disabled:ue||!b.newPassword||!b.confirmPassword,className:"bg-[#1B5AAB] hover:bg-[#164a94] text-white",children:ue?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-4 h-4 mr-2 animate-spin"}),"Elaborazione..."]}):"Cambia Password"})]}),e.jsx("div",{className:"mt-4 p-3 bg-green-50 rounded-md",children:e.jsxs("p",{className:"text-sm text-green-700",children:[e.jsx("strong",{children:"Nota:"})," Essendo già autenticato, puoi cambiare direttamente la password senza inserire quella attuale."]})})]})})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsx(C,{children:e.jsx(z,{className:"text-[#1B5AAB]",children:"Riepilogo Account"})}),e.jsx(B,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Benvenuto,"}),e.jsxs("p",{className:"font-semibold",children:[l==null?void 0:l.first_name," ",l==null?void 0:l.last_name]}),e.jsx("p",{className:"text-sm text-gray-600",children:l==null?void 0:l.email})]})})]}),D&&D.length>0&&e.jsxs(A,{children:[e.jsx(C,{children:e.jsx(z,{className:"text-[#1B5AAB]",children:"Ultimo Ordine"})}),e.jsx(B,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"font-semibold",children:["#",D[0].number]}),e.jsx("p",{className:"text-sm text-gray-600",children:me(D[0].date_created)}),e.jsx("p",{className:"font-semibold",children:Ne(D[0].total)})]})})]})]})]})]})}),e.jsx(K,{open:I,onOpenChange:o,children:e.jsxs(Q,{className:"backdrop-blur-sm",children:[e.jsxs(V,{children:[e.jsx(G,{children:"Modifica Profilo"}),e.jsx(X,{children:"Aggiorna le informazioni del tuo profilo utente."})]}),e.jsx(rs,{customer:l,onClose:()=>o(!1)})]})}),e.jsx(K,{open:$,onOpenChange:S,children:e.jsxs(Q,{className:"max-w-sm mx-2 sm:mx-4 rounded-xl shadow-2xl border-0 max-h-[85vh] overflow-y-auto backdrop-blur-sm",children:[e.jsxs(V,{className:"space-y-1 pb-2",children:[e.jsxs(G,{className:"flex items-center text-lg sm:text-xl font-bold text-gray-800",children:[e.jsx(L,{className:"w-5 h-5 sm:w-6 sm:h-6 mr-2",style:{color:"#1B5AAB"}}),"Modifica Indirizzo"]}),e.jsx(X,{className:"text-gray-600 text-sm sm:text-base leading-relaxed",children:"Modifica le informazioni del tuo indirizzo di consegna."})]}),e.jsx(is,{customer:l,onClose:()=>S(!1)})]})}),e.jsx(K,{open:M,onOpenChange:F,children:e.jsxs(Q,{className:"max-w-4xl backdrop-blur-sm",children:[e.jsxs(V,{children:[e.jsx(G,{children:"Dettagli Ordine"}),e.jsx(X,{children:"Visualizza i dettagli completi del tuo ordine."})]}),U&&e.jsx(os,{order:U})]})}),e.jsx(K,{open:ae,onOpenChange:Z,children:e.jsxs(Q,{className:"max-w-sm mx-2 sm:mx-4 rounded-xl shadow-2xl border-0 max-h-[85vh] overflow-y-auto backdrop-blur-sm",children:[e.jsxs(V,{className:"space-y-1 sm:space-y-2 pb-3 sm:pb-4",children:[e.jsxs(G,{className:"flex items-center text-lg sm:text-xl font-bold text-[#1B5AAB]",children:[e.jsx(L,{className:"w-5 h-5 sm:w-6 sm:h-6 mr-2",style:{color:"#1B5AAB"}}),"Nuovo Indirizzo"]}),e.jsx(X,{className:"text-gray-600 text-xs sm:text-sm leading-relaxed",children:"Aggiungi un nuovo indirizzo per le tue consegne future."})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3 pt-2",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"newTitle",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Titolo (es. Casa, Ufficio)"}),e.jsx(p,{id:"newTitle",name:"title",value:n.title,onChange:$e,placeholder:"Casa",className:"h-8 sm:h-9 border border-[#1B5AAB] rounded-md focus:border-[#1B5AAB] focus:ring-1 focus:ring-[#1B5AAB]/20 transition-all duration-200 text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-xs sm:text-sm"})]}),e.jsx("div",{children:e.jsx(Se,{label:"Indirizzo",placeholder:"Inizia a digitare l'indirizzo...",value:n.address,onChange:s=>{j({...n,address:s})},onAddressSelect:s=>{j({...n,address:s.address,city:s.city,province:s.province,postalCode:s.postalCode})},className:"text-xs sm:text-sm",required:!0})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Città *"}),e.jsx(p,{value:n.city,onChange:s=>j(a=>({...a,city:s.target.value})),placeholder:"Inserisci la Città",className:"text-xs sm:text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Provincia *"}),e.jsx(p,{value:n.province,onChange:s=>j(a=>({...a,province:s.target.value})),placeholder:"Inserisci la Provincia",className:"text-xs sm:text-sm",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"CAP *"}),e.jsx(p,{value:n.postalCode,onChange:s=>j(a=>({...a,postalCode:s.target.value})),placeholder:"Inserisci il Cap",className:"text-xs sm:text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Paese"}),e.jsx(p,{value:"IT",className:"h-8 sm:h-9 border border-gray-300 rounded-md bg-gray-50 text-gray-600 cursor-not-allowed text-xs sm:text-sm",readOnly:!0})]})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 pt-4 sm:pt-6",children:[e.jsx(y,{variant:"outline",onClick:()=>{Z(!1),j({title:"",address:"",city:"",province:"",postalCode:"",notes:""})},className:"flex-1 h-8 sm:h-9 border border-[#1B5AAB] text-[#1B5AAB] hover:bg-[#1B5AAB] hover:text-white rounded-md font-medium transition-all duration-200 text-xs sm:text-sm",children:"Annulla"}),e.jsx(y,{onClick:Me,className:"flex-1 h-8 sm:h-9 bg-[#1B5AAB] hover:bg-[#164a94] text-white rounded-md font-medium transition-all duration-200 shadow-sm hover:shadow-md text-xs sm:text-sm",children:"Salva Indirizzo"})]})]})]})}),e.jsx(K,{open:ne,onOpenChange:q,children:e.jsxs(Q,{className:"max-w-sm mx-2 sm:mx-4 rounded-xl shadow-2xl border-0 max-h-[85vh] overflow-y-auto",children:[e.jsxs(V,{className:"space-y-1 pb-2",children:[e.jsxs(G,{className:"flex items-center text-lg sm:text-xl font-bold text-gray-800",children:[e.jsx(L,{className:"w-5 h-5 sm:w-6 sm:h-6 mr-2",style:{color:"#1B5AAB"}}),"Modifica Indirizzo"]}),e.jsx(X,{className:"text-gray-600 text-sm sm:text-base leading-relaxed",children:"Modifica i dettagli del tuo indirizzo."})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"editTitle",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Titolo (es. Casa, Ufficio)"}),e.jsx(p,{id:"editTitle",name:"title",value:n.title,onChange:s=>j(a=>({...a,title:s.target.value})),placeholder:"Casa",className:"h-8 sm:h-9 focus:ring-[#1B5AAB] rounded-md text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-sm border-gray-300 focus:border-[#1B5AAB]"})]}),e.jsx("div",{children:e.jsx(Se,{label:"Indirizzo",placeholder:"Inizia a digitare l'indirizzo...",value:n.address,onChange:s=>{j({...n,address:s})},onAddressSelect:s=>{j({...n,address:s.address,city:s.city,province:s.province,postalCode:s.postalCode})},required:!0,focusTargetId:"save-address-button"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Città *"}),e.jsx(p,{value:n.city,onChange:s=>j(a=>({...a,city:s.target.value})),placeholder:"Inserisci la Città",required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Provincia *"}),e.jsx(p,{value:n.province,onChange:s=>j(a=>({...a,province:s.target.value})),placeholder:"Inserisci la Provincia",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"CAP *"}),e.jsx(p,{value:n.postalCode,onChange:s=>j(a=>({...a,postalCode:s.target.value})),placeholder:"Inserisci il Cap",required:!0})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Paese"}),e.jsx(p,{value:"IT",className:"h-8 sm:h-9 bg-gray-50 border-gray-200 text-gray-500 rounded-md text-sm",readOnly:!0})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(y,{variant:"outline",onClick:()=>{q(!1),w(null),j({title:"",address:"",city:"",province:"",postalCode:"",notes:""})},className:"flex-1 h-8 sm:h-9 border-2 border-gray-300 text-gray-700 hover:bg-[#A40800] hover:text-white hover:border-[#A40800] transition-all duration-200 rounded-md font-medium text-sm",children:"Annulla"}),e.jsx(y,{onClick:async()=>{if(!n.address||!n.city||!n.province||!n.postalCode){h.error("Compila tutti i campi obbligatori");return}fe(!0);try{const s=await oe({address:n.address,city:n.city,province:n.province,postalCode:n.postalCode}),a=Y({city:n.city,province:n.province,postalCode:n.postalCode,coordinates:s?{lat:s.lat,lng:s.lng}:void 0}),r={title:n.title||(O==null?void 0:O.title),address:n.address,city:n.city,province:n.province,postalCode:n.postalCode,notes:n.notes,coordinates:s?{lat:s.lat,lng:s.lng}:void 0,deliveryZone:a?{id:a.id,name:a.name,color:a.color}:null},d=f.map(t=>t.id===(O==null?void 0:O.id)?{...t,...r}:t);if(l&&i.isAuthenticated)try{const t=d.map(x=>({id:x.id,title:x.title||"",address:x.address||"",city:x.city||"",province:x.province||"",postalCode:x.postalCode||"",notes:x.notes||"",coordinates:x.coordinates||null,deliveryZone:x.deliveryZone||null})),_=((l==null?void 0:l.meta_data)||[]).filter(x=>x.key!=="saved_addresses"),P=JSON.stringify(t);JSON.parse(P),_.push({key:"saved_addresses",value:P}),await H.mutateAsync({id:l.id,customerData:{meta_data:_}})}catch(t){console.error("Errore nella serializzazione degli indirizzi:",t),h.error("Errore nel salvataggio dell'indirizzo");return}N(d),q(!1),w(null),a?h.success(`Indirizzo aggiornato e assegnato alla ${a.name}`):h.success("Indirizzo modificato con successo!")}catch(s){console.error("Errore nel salvataggio:",s),h.error("Errore nel salvataggio dell'indirizzo")}finally{fe(!1)}},id:"save-address-button",disabled:ve,className:"flex-1 h-8 sm:h-9 bg-[#1B5AAB] hover:bg-[#164a94] text-white disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 rounded-md font-medium shadow-lg hover:shadow-xl text-sm",children:ve?e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(ee,{className:"w-3 h-3 sm:w-4 sm:h-4 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Salvando..."}),e.jsx("span",{className:"sm:hidden",children:"..."})]}):"Salva Modifiche"})]})]})})]})};export{Fs as default};
