import{j as e,s as ee,d as Ze,O as xe,$ as he,M as L,H as Je,a0 as Re,a1 as ze,a2 as Ue,B as We,Q as He,F as Ke,a3 as Qe}from"./ui-vendor-CBu0MraC.js";import{r as m}from"./react-vendor-DTdTrAaS.js";import{B as Ve,H as Ge}from"./Header-Chz8Xda_.js";import{I as x,B as y}from"./input-BrCX-FV-.js";import{C as z,b as _,c as P,a as I}from"./card-CJGvcwoN.js";import{f as Ie,g as Xe,e as Ye,b as es}from"./useWooCommerce-izqWt-aK.js";import{c as ss,u as is,J as g}from"./index-I5fS8uHh.js";import{D as K,a as Q,b as V,c as G,d as X,E as as}from"./EditAddress-DvKwgc6D.js";import{L as h}from"./label-BP42n_nh.js";import{e as Y,d as ts}from"./deliveryZones-DdzeKIHd.js";import{A as _e,a as de}from"./AddressAutocomplete-BRjemWj9.js";import ns from"./Login-WkxcfJal.js";import"./router-vendor-C3VyKldT.js";import"./query-vendor-CZPvIwdz.js";import"./chart-vendor-tNssjKKI.js";import"./utils-vendor-BbYF_8OW.js";import"./alert-cqSDNtBl.js";import"./Register-CRG7JJxq.js";const ls=({customer:i,onClose:u})=>{const[c,C]=m.useState({first_name:i.first_name,last_name:i.last_name,email:i.email,username:i.username,billing:{...i.billing,phone:i.billing.phone||""}}),N=Ie(),o=B=>{const{name:$,value:D}=B.target;C($==="phone"?{...c,billing:{...c.billing,phone:D}}:{...c,[$]:D})},E=B=>{B.preventDefault(),N.mutate({id:i.id,customerData:c},{onSuccess:()=>{console.log("Chiusura del dialogo in corso..."),u()}})};return e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"first_name",children:"Nome"}),e.jsx(x,{id:"first_name",name:"first_name",value:c.first_name,onChange:o,required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"last_name",children:"Cognome"}),e.jsx(x,{id:"last_name",name:"last_name",value:c.last_name,onChange:o,required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"email",children:"Email"}),e.jsx(x,{id:"email",name:"email",type:"email",value:c.email,onChange:o,required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"username",children:"Username"}),e.jsx(x,{id:"username",name:"username",value:c.username,onChange:o,required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"phone",children:"Telefono"}),e.jsx(x,{id:"phone",name:"phone",value:c.billing.phone,onChange:o})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(y,{type:"button",variant:"outline",onClick:u,children:"Annulla"}),e.jsx(y,{type:"submit",disabled:N.isPending,children:N.isPending?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-4 h-4 animate-spin mr-2"}),"Salvataggio..."]}):"Salva Modifiche"})]})]})};var rs="Separator",Pe="horizontal",os=["horizontal","vertical"],Se=m.forwardRef((i,u)=>{const{decorative:c,orientation:C=Pe,...N}=i,o=ds(C)?C:Pe,B=c?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return e.jsx(Ze.div,{"data-orientation":o,...B,...N,ref:u})});Se.displayName=rs;function ds(i){return os.includes(i)}var Oe=Se;const ke=m.forwardRef(({className:i,orientation:u="horizontal",decorative:c=!0,...C},N)=>e.jsx(Oe,{ref:N,decorative:c,orientation:u,className:ss("shrink-0 bg-border",u==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",i),...C}));ke.displayName=Oe.displayName;const cs=({order:i})=>{const u=o=>new Date(o).toLocaleDateString("it-IT",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=o=>`${parseFloat(o).toFixed(2)}€`,C=o=>{switch(o){case"completed":return"bg-green-100 text-green-800";case"processing":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"refunded":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},N=o=>{switch(o){case"completed":return"Completato";case"processing":return"In elaborazione";case"pending":return"In attesa";case"cancelled":return"Annullato";case"refunded":return"Rimborsato";default:return o}};return e.jsxs("div",{className:"space-y-6 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-[#1B5AAB]",children:["Ordine #",i.number]}),e.jsxs("p",{className:"text-gray-600",children:["Creato il ",u(i.date_created)]})]}),e.jsx(Ve,{className:C(i.status),children:N(i.status)})]}),e.jsxs(z,{children:[e.jsx(_,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5"}),"Prodotti Ordinati"]})}),e.jsx(I,{children:e.jsx("div",{className:"space-y-4",children:i.line_items.map((o,E)=>e.jsxs("div",{className:"flex justify-between items-center p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[o.image&&e.jsx("img",{src:o.image.src,alt:o.name,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:o.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["SKU: ",o.sku]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Quantità: ",o.quantity]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold",children:c(o.total)}),e.jsxs("p",{className:"text-sm text-gray-600",children:[c((parseFloat(o.total)/o.quantity).toString())," cad."]})]})]},o.id))})})]}),e.jsxs(z,{children:[e.jsx(_,{children:e.jsx(P,{children:"Riepilogo Ordine"})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotale:"}),e.jsx("span",{children:c((parseFloat(i.total)-parseFloat(i.shipping_total)-parseFloat(i.total_tax)).toString())})]}),parseFloat(i.shipping_total)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Spedizione:"}),e.jsx("span",{children:c(i.shipping_total)})]}),parseFloat(i.total_tax)>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tasse:"}),e.jsx("span",{children:c(i.total_tax)})]}),parseFloat(i.discount_total)>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Sconto:"}),e.jsxs("span",{children:["-",c(i.discount_total)]})]}),e.jsx(ke,{}),e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("span",{children:"Totale:"}),e.jsx("span",{children:c(i.total)})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(z,{children:[e.jsx(_,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),"Indirizzo di Fatturazione"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"font-semibold",children:[i.billing.first_name," ",i.billing.last_name]}),i.billing.company&&e.jsx("p",{children:i.billing.company}),e.jsx("p",{children:i.billing.address_1}),i.billing.address_2&&e.jsx("p",{children:i.billing.address_2}),e.jsxs("p",{children:[i.billing.postcode," ",i.billing.city]}),e.jsxs("p",{children:[i.billing.state,", ",i.billing.country]}),e.jsx("p",{className:"text-sm text-gray-600",children:i.billing.email}),i.billing.phone&&e.jsx("p",{className:"text-sm text-gray-600",children:i.billing.phone})]})})]}),e.jsxs(z,{children:[e.jsx(_,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"Indirizzo di Spedizione"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"font-semibold",children:[i.shipping.first_name," ",i.shipping.last_name]}),i.shipping.company&&e.jsx("p",{children:i.shipping.company}),e.jsx("p",{children:i.shipping.address_1}),i.shipping.address_2&&e.jsx("p",{children:i.shipping.address_2}),e.jsxs("p",{children:[i.shipping.postcode," ",i.shipping.city]}),e.jsxs("p",{children:[i.shipping.state,", ",i.shipping.country]})]})})]})]}),e.jsxs(z,{children:[e.jsx(_,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5"}),"Informazioni Pagamento"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Metodo di Pagamento:"}),e.jsx("span",{className:"font-semibold",children:i.payment_method_title})]}),i.transaction_id&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ID Transazione:"}),e.jsx("span",{className:"font-mono text-sm",children:i.transaction_id})]}),i.date_paid&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Data Pagamento:"}),e.jsx("span",{children:u(i.date_paid)})]}),i.date_completed&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Data Completamento:"}),e.jsx("span",{children:u(i.date_completed)})]})]})})]}),i.customer_note&&e.jsxs(z,{children:[e.jsx(_,{children:e.jsx(P,{children:"Note del Cliente"})}),e.jsx(I,{children:e.jsx("p",{className:"text-gray-700",children:i.customer_note})})]})]})},ms=({customer:i})=>{var E,B,$,D,U,se,Z,ie;const[u,c]=m.useState(null),[C,N]=m.useState(!0);if(m.useEffect(()=>{const f=async()=>{var A,ae,T,te,W,ne,q,F;N(!0);try{const w={city:((A=i.shipping)==null?void 0:A.city)||((ae=i.billing)==null?void 0:ae.city)||"",province:((T=i.shipping)==null?void 0:T.state)||((te=i.billing)==null?void 0:te.state)||"",postalCode:((W=i.shipping)==null?void 0:W.postcode)||((ne=i.billing)==null?void 0:ne.postcode)||"",address:((q=i.shipping)==null?void 0:q.address_1)||((F=i.billing)==null?void 0:F.address_1)||""},n=`${w.address}, ${w.city}, ${w.province} ${w.postalCode}`;let v=Y(w);if(!v&&w.address&&w.city)try{const b=await de(w);b&&(v=ts(b.lat,b.lng))}catch(b){console.warn("Errore nella geocodifica:",b)}c(v)}catch(w){console.error("Errore nella determinazione della zona:",w)}finally{N(!1)}};i!=null&&i.shipping||i!=null&&i.billing?f():N(!1)},[i]),C)return e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(ee,{className:"w-3 h-3 mr-2 animate-spin"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Determinazione zona..."})]});const o=`${((E=i.shipping)==null?void 0:E.address_1)||((B=i.billing)==null?void 0:B.address_1)}, ${(($=i.shipping)==null?void 0:$.city)||((D=i.billing)==null?void 0:D.city)}, ${((U=i.shipping)==null?void 0:U.state)||((se=i.billing)==null?void 0:se.state)} ${((Z=i.shipping)==null?void 0:Z.postcode)||((ie=i.billing)==null?void 0:ie.postcode)}`;return u?e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:u.color}}),e.jsx("span",{className:"text-xs font-medium",style:{color:u.color},children:u.name})]}):e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-2 bg-gray-400"}),e.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["Zona non identificata - Debug: ",o]})]})},Os=()=>{var ye,Ne,Ae,we,Ce,Be;const{authState:i,logout:u}=is(),[c,C]=m.useState("profile");m.useState(!1),m.useState(!1),m.useState(!1);const[N,o]=m.useState(!1),[E,B]=m.useState(!1),[$,D]=m.useState(!1),[U,se]=m.useState(null),[Z,ie]=m.useState(!1),[f,A]=m.useState([]),[ae,T]=m.useState(!1),[te,W]=m.useState(null),[ne,q]=m.useState(!1),[F,w]=m.useState(null),[n,v]=m.useState({title:"",address:"",city:"",province:"",postalCode:"",notes:""}),[b,pe]=m.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[ge,ue]=m.useState(!1),[je,ve]=m.useState(!1),le=(ye=i==null?void 0:i.user)!=null&&ye.id&&i.user.id>0?i.user.id:null,H=!le&&!!((Ne=i==null?void 0:i.user)!=null&&Ne.email)&&!Z,{data:re,isLoading:J}=Xe(((Ae=i==null?void 0:i.user)==null?void 0:Ae.email)||"",{enabled:H&&!!(i!=null&&i.isAuthenticated)}),j=m.useMemo(()=>le||(re&&re.length>0?re[0].id:null),[le,re]),{data:l,isLoading:fe,error:xs}=Ye(j||0,{enabled:!!j&&j>0&&!!(i!=null&&i.isAuthenticated)}),{data:M,isLoading:Fe,error:hs}=es(j||0,{per_page:5},{enabled:!!j&&j>0&&!!(i!=null&&i.isAuthenticated)}),R=Ie();m.useEffect(()=>{(!H||H&&!J)&&ie(!0)},[H,J]);const Ee=async s=>await Promise.all(s.map(async r=>{const d=Y({city:r.city,province:r.province,postalCode:r.postalCode,coordinates:r.coordinates});return{...r,deliveryZone:d?{id:d.id,name:d.name,color:d.color}:null}}));m.useEffect(()=>{if(l&&l.meta_data){const s=l.meta_data.find(a=>a.key==="saved_addresses");if(s&&s.value)try{const a=JSON.parse(s.value);Ee(a).then(r=>{if(A(r),JSON.stringify(a)!==JSON.stringify(r)&&(console.log("Aggiornamento colori zone per indirizzi salvati"),j&&i.isAuthenticated&&l)){const t=((l==null?void 0:l.meta_data)||[]).filter(k=>k.key!=="saved_addresses");t.push({key:"saved_addresses",value:JSON.stringify(r)}),R.mutateAsync({id:j,customerData:{meta_data:t}}).catch(k=>{console.error("Errore nell'aggiornamento colori zone:",k)})}})}catch(a){console.error("Errore nel parsing degli indirizzi salvati:",a)}}},[l,j,i.isAuthenticated]);const oe=s=>{const{name:a,value:r}=s.target;v(d=>({...d,[a]:r}))},De=async()=>{if(!n.address||!n.city||!n.province||!n.postalCode){g.error("Compila tutti i campi obbligatori");return}const s=await de({address:n.address,city:n.city,province:n.province,postalCode:n.postalCode}),a=Y({city:n.city,province:n.province,postalCode:n.postalCode,coordinates:s?{lat:s.lat,lng:s.lng}:void 0}),r={id:Date.now(),title:n.title||`Indirizzo ${f.length+1}`,address:n.address,city:n.city,province:n.province,postalCode:n.postalCode,notes:n.notes,coordinates:s?{lat:s.lat,lng:s.lng}:void 0,deliveryZone:a?{id:a.id,name:a.name,color:a.color}:null};a?g.success(`Indirizzo assegnato alla ${a.name}`):g.warning("Zona di consegna non determinata automaticamente");const d=[...f,r];if(A(d),j&&i.isAuthenticated)try{await R.mutateAsync({id:j,customerData:{meta_data:[{key:"saved_addresses",value:JSON.stringify(d)}]}}),g.success("Indirizzo salvato con successo!"),T(!1),v({title:"",address:"",city:"",province:"",postalCode:"",notes:""})}catch(t){console.error("Errore nel salvataggio dell'indirizzo:",t),g.error("Errore nel salvataggio dell'indirizzo")}},Me=async s=>{const a=f.filter(r=>r.id!==s);if(A(a),j&&i.isAuthenticated)try{await R.mutateAsync({id:j,customerData:{meta_data:[{key:"saved_addresses",value:JSON.stringify(a)}]}}),g.success("Indirizzo eliminato con successo!")}catch(r){console.error("Errore nell'eliminazione dell'indirizzo:",r),g.error("Errore nell'eliminazione dell'indirizzo")}},$e=async(s,a)=>{let r={...a};if(a.city||a.province||a.postalCode||a.address){const t=f.find(k=>k.id===s);if(t){const k={address:a.address||t.address,city:a.city||t.city,province:a.province||t.province,postalCode:a.postalCode||t.postalCode},S=await de(k),O=Y({...k,coordinates:S?{lat:S.lat,lng:S.lng}:void 0});r.deliveryZone=O?{id:O.id,name:O.name,color:O.color}:null,S&&(r.coordinates={lat:S.lat,lng:S.lng}),O?g.success(`Indirizzo aggiornato e assegnato alla ${O.name}`):g.warning("Zona di consegna non determinata per l'indirizzo aggiornato")}}const d=f.map(t=>t.id===s?{...t,...r}:t);if(A(d),j&&i.isAuthenticated&&l)try{const t=d.map(p=>({id:p.id,title:p.title||"",address:p.address||"",city:p.city||"",province:p.province||"",postalCode:p.postalCode||"",notes:p.notes||"",coordinates:p.coordinates||null,deliveryZone:p.deliveryZone||null})),S=((l==null?void 0:l.meta_data)||[]).filter(p=>p.key!=="saved_addresses"),O=JSON.stringify(t);JSON.parse(O),S.push({key:"saved_addresses",value:O}),await R.mutateAsync({id:j,customerData:{meta_data:S}}),g.success("Indirizzo aggiornato con successo!"),W(null)}catch(t){console.error("Errore nell'aggiornamento dell'indirizzo:",t),g.error("Errore nell'aggiornamento dell'indirizzo")}},ce=s=>{const{name:a,value:r}=s.target;pe(d=>({...d,[a]:r}))},Te=async()=>{if(!b.newPassword||!b.confirmPassword){g.error("Compila tutti i campi obbligatori");return}if(b.newPassword!==b.confirmPassword){g.error("Le password non coincidono");return}if(b.newPassword.length<6){g.error("La password deve essere di almeno 6 caratteri");return}ue(!0);try{if(j&&i.isAuthenticated){if(l){const a=((l==null?void 0:l.meta_data)||[]).filter(r=>r.key!=="password_change_request");a.push({key:"password_change_request",value:new Date().toISOString()}),await R.mutateAsync({id:j,customerData:{meta_data:a}})}g.success("Richiesta di cambio password inviata! Controlla la tua email per completare il processo."),pe({currentPassword:"",newPassword:"",confirmPassword:""})}}catch(s){console.error("Errore nel cambio password:",s),g.error("Errore nell'invio della richiesta")}finally{ue(!1)}};if(!i)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Inizializzazione..."})]})});if(!i.isAuthenticated)return e.jsx(ns,{});if(J)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Ricerca profilo cliente..."})]})});if(j&&fe)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Caricamento dati account..."})]})});if(!j&&Z)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Profilo Temporaneo"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Benvenuto, ",(we=i.user)==null?void 0:we.email]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Il tuo account non è ancora collegato a un profilo WooCommerce."}),e.jsx("button",{onClick:u,className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700",children:"Logout"})]})});if(!j&&!H)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Profilo Non Trovato"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Benvenuto, ",(Ce=i.user)==null?void 0:Ce.email]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Non è possibile trovare il tuo profilo WooCommerce."}),e.jsx("button",{onClick:u,className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700",children:"Logout"})]})});if(!j&&Z&&!J)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Profilo Non Trovato"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Benvenuto, ",(Be=i.user)==null?void 0:Be.email]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Non è stato possibile trovare il tuo profilo WooCommerce."}),e.jsx("button",{onClick:u,className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700",children:"Logout"})]})});if(J||fe)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:J?"Ricerca profilo cliente...":"Caricamento dati account..."})]})});const me=s=>new Date(s).toLocaleDateString("it-IT"),be=s=>`${parseFloat(s).toFixed(2)}€`,qe=()=>{u(),g.success("Logout effettuato con successo!")},Le=s=>{se(s),D(!0)};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ge,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#1B5AAB]",children:"Il Mio Account"}),e.jsxs(y,{onClick:qe,style:{backgroundColor:"#A40800"},className:"text-white flex items-center gap-2 px-4 py-2 rounded-md hover:opacity-90",children:[e.jsx(Re,{className:"w-4 h-4"}),"Logout"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-8 border-b",children:[{id:"profile",label:"Profilo",icon:he},{id:"orders",label:"Ordini",icon:xe},{id:"address",label:"Indirizzo",icon:L},{id:"settings",label:"Impostazioni",icon:ze}].map(s=>{const a=s.icon;return e.jsxs("button",{onClick:()=>C(s.id),className:`flex items-center gap-2 px-4 py-2 rounded-t-lg transition-colors ${c===s.id?"bg-[#1B5AAB] text-white border-b-2 border-[#1B5AAB]":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(a,{className:"w-4 h-4"}),s.label]},s.id)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[c==="profile"&&e.jsxs(z,{children:[e.jsx(_,{children:e.jsxs(P,{className:"flex items-center gap-2 text-[#1B5AAB]",children:[e.jsx(he,{className:"w-5 h-5"}),"Informazioni Profilo"]})}),e.jsx(I,{children:l?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nome"}),e.jsx("p",{className:"text-lg",children:l.first_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Cognome"}),e.jsx("p",{className:"text-lg",children:l.last_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Email"}),e.jsx("p",{className:"text-lg",children:l.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Data registrazione"}),e.jsx("p",{className:"text-lg",children:me(l.date_created)})]})]}),e.jsx(y,{onClick:()=>o(!0),className:"mt-4",children:"Modifica Profilo"})]}):e.jsx("p",{children:"Caricamento dati profilo..."})})]}),c==="orders"&&e.jsxs(z,{children:[e.jsx(_,{children:e.jsxs(P,{className:"flex items-center gap-2 text-[#1B5AAB]",children:[e.jsx(xe,{className:"w-5 h-5"}),"I Miei Ordini"]})}),e.jsx(I,{children:Fe?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ee,{className:"w-6 h-6 animate-spin"})}):M&&M.length>0?e.jsx("div",{className:"space-y-4",children:M.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>Le(s),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold",children:["Ordine #",s.number]}),e.jsx("p",{className:"text-sm text-gray-600",children:me(s.date_created)})]}),e.jsxs("div",{className:"text-right flex items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:be(s.total)}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="processing"?"bg-blue-100 text-blue-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status})]}),e.jsx(Ue,{className:"w-4 h-4 text-gray-400"})]})]}),e.jsx("div",{className:"text-sm text-gray-600",children:s.line_items.map(a=>e.jsxs("div",{children:[a.name," x ",a.quantity]},a.id))})]},s.id))}):e.jsx("p",{className:"text-center py-8 text-gray-500",children:"Nessun ordine trovato"})})]}),c==="address"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{children:[e.jsx(_,{children:e.jsxs(P,{className:"flex items-center gap-2 text-[#1B5AAB]",children:[e.jsx(L,{className:"w-5 h-5"}),"Indirizzo Principale"]})}),e.jsx(I,{children:l!=null&&l.shipping?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[l.shipping.first_name," ",l.shipping.last_name]}),e.jsx("p",{children:l.shipping.address_1}),e.jsxs("p",{children:[l.shipping.postcode," ",l.shipping.city]}),e.jsxs("p",{children:[l.shipping.state,", ",l.shipping.country]}),e.jsx(ms,{customer:l}),e.jsx(y,{onClick:()=>B(!0),className:"mt-4",children:"Modifica Indirizzo Principale"})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"Nessun indirizzo di spedizione configurato"}),e.jsx(y,{onClick:()=>B(!0),children:"Aggiungi Indirizzo Principale"})]})})]}),e.jsxs(z,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(P,{className:"flex items-center gap-2 text-[#1B5AAB]",children:[e.jsx(L,{className:"w-5 h-5"}),"Altri indirizzi di Consegna"]}),e.jsxs(y,{onClick:()=>T(!0),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:[e.jsx(We,{className:"w-4 h-4"}),"Aggiungi Indirizzo"]})]})}),e.jsx(I,{children:f.length>0?e.jsx("div",{className:"space-y-4",children:f.map(s=>{var a;return e.jsx("div",{className:"border-2 rounded-lg p-4",style:{borderColor:((a=s.deliveryZone)==null?void 0:a.color)||"#d1d5db"},children:te===s.id?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:`edit-title-${s.id}`,children:"Titolo"}),e.jsx(x,{id:`edit-title-${s.id}`,value:s.title,onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,title:r.target.value}:t);A(d)}})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:`edit-address-${s.id}`,children:"Indirizzo *"}),e.jsx(x,{id:`edit-address-${s.id}`,value:s.address,onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,address:r.target.value}:t);A(d)},required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:`edit-city-${s.id}`,children:"Città *"}),e.jsx(x,{id:`edit-city-${s.id}`,value:s.city,onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,city:r.target.value}:t);A(d)},required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:`edit-province-${s.id}`,children:"Provincia *"}),e.jsx(x,{id:`edit-province-${s.id}`,value:s.province,onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,province:r.target.value}:t);A(d)},required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:`edit-postalCode-${s.id}`,children:"CAP *"}),e.jsx(x,{id:`edit-postalCode-${s.id}`,value:s.postalCode,onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,postalCode:r.target.value}:t);A(d)},required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:`edit-notes-${s.id}`,children:"Note"}),e.jsx(x,{id:`edit-notes-${s.id}`,value:s.notes||"",onChange:r=>{const d=f.map(t=>t.id===s.id?{...t,notes:r.target.value}:t);A(d)}})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{onClick:()=>$e(s.id,s),className:"bg-green-600 hover:bg-green-700",children:"Salva"}),e.jsx(y,{onClick:()=>W(null),variant:"outline",children:"Annulla"})]})]}):e.jsx("div",{children:e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("h3",{className:"font-semibold text-lg",children:s.title})}),e.jsx("p",{className:"text-gray-600",children:s.address}),e.jsxs("p",{className:"text-gray-600",children:[s.postalCode," ",s.city,", ",s.province]}),s.notes&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Note: ",s.notes]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{onClick:()=>{w(s),v({title:s.title,address:s.address,city:s.city,province:s.province,postalCode:s.postalCode,notes:s.notes||""}),q(!0)},variant:"outline",size:"sm",className:"flex items-center gap-1",children:[e.jsx(He,{className:"w-4 h-4"}),"Modifica"]}),e.jsxs(y,{onClick:()=>Me(s.id),variant:"outline",size:"sm",className:"flex items-center gap-1 text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(Ke,{className:"w-4 h-4"}),"Elimina"]})]})]})})},s.id)})}):e.jsx("p",{className:"text-center py-8 text-gray-500",children:"Nessun indirizzo salvato"})})]})]}),c==="settings"&&e.jsxs(z,{children:[e.jsx(_,{children:e.jsxs(P,{className:"flex items-center gap-2 text-[#1B5AAB]",children:[e.jsx(ze,{className:"w-5 h-5"}),"Impostazioni Account"]})}),e.jsx(I,{children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Qe,{className:"w-5 h-5 text-[#1B5AAB]"}),e.jsx("h3",{className:"text-lg font-semibold text-[#1B5AAB]",children:"Cambia Password"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"currentPassword",className:"text-sm font-medium text-gray-700",children:"Password Attuale"}),e.jsx(x,{id:"currentPassword",name:"currentPassword",type:"password",value:b.currentPassword,onChange:ce,placeholder:"Inserisci la password attuale",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"newPassword",className:"text-sm font-medium text-gray-700",children:"Nuova Password *"}),e.jsx(x,{id:"newPassword",name:"newPassword",type:"password",value:b.newPassword,onChange:ce,placeholder:"Inserisci la nuova password (min. 6 caratteri)",className:"mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"confirmPassword",className:"text-sm font-medium text-gray-700",children:"Conferma Nuova Password *"}),e.jsx(x,{id:"confirmPassword",name:"confirmPassword",type:"password",value:b.confirmPassword,onChange:ce,placeholder:"Conferma la nuova password",className:"mt-1",required:!0})]}),e.jsx(y,{onClick:Te,disabled:ge||!b.newPassword||!b.confirmPassword,className:"bg-[#1B5AAB] hover:bg-[#164a94] text-white",children:ge?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-4 h-4 mr-2 animate-spin"}),"Elaborazione..."]}):"Cambia Password"})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Nota:"})," Per motivi di sicurezza, il cambio password richiede una verifica via email. Riceverai un link per completare il processo."]})})]})})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(z,{children:[e.jsx(_,{children:e.jsx(P,{className:"text-[#1B5AAB]",children:"Riepilogo Account"})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Benvenuto,"}),e.jsxs("p",{className:"font-semibold",children:[l==null?void 0:l.first_name," ",l==null?void 0:l.last_name]}),e.jsx("p",{className:"text-sm text-gray-600",children:l==null?void 0:l.email})]})})]}),M&&M.length>0&&e.jsxs(z,{children:[e.jsx(_,{children:e.jsx(P,{className:"text-[#1B5AAB]",children:"Ultimo Ordine"})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"font-semibold",children:["#",M[0].number]}),e.jsx("p",{className:"text-sm text-gray-600",children:me(M[0].date_created)}),e.jsx("p",{className:"font-semibold",children:be(M[0].total)})]})})]})]})]})]})}),e.jsx(K,{open:N,onOpenChange:o,children:e.jsxs(Q,{className:"backdrop-blur-sm",children:[e.jsxs(V,{children:[e.jsx(G,{children:"Modifica Profilo"}),e.jsx(X,{children:"Aggiorna le informazioni del tuo profilo utente."})]}),e.jsx(ls,{customer:l,onClose:()=>o(!1)})]})}),e.jsx(K,{open:E,onOpenChange:B,children:e.jsxs(Q,{className:"max-w-sm mx-2 sm:mx-4 rounded-xl shadow-2xl border-0 max-h-[85vh] overflow-y-auto backdrop-blur-sm",children:[e.jsxs(V,{className:"space-y-1 pb-2",children:[e.jsxs(G,{className:"flex items-center text-lg sm:text-xl font-bold text-gray-800",children:[e.jsx(L,{className:"w-5 h-5 sm:w-6 sm:h-6 mr-2",style:{color:"#1B5AAB"}}),"Modifica Indirizzo"]}),e.jsx(X,{className:"text-gray-600 text-sm sm:text-base leading-relaxed",children:"Modifica le informazioni del tuo indirizzo di consegna."})]}),e.jsx(as,{customer:l,onClose:()=>B(!1)})]})}),e.jsx(K,{open:$,onOpenChange:D,children:e.jsxs(Q,{className:"max-w-4xl backdrop-blur-sm",children:[e.jsxs(V,{children:[e.jsx(G,{children:"Dettagli Ordine"}),e.jsx(X,{children:"Visualizza i dettagli completi del tuo ordine."})]}),U&&e.jsx(cs,{order:U})]})}),e.jsx(K,{open:ae,onOpenChange:T,children:e.jsxs(Q,{className:"max-w-sm mx-2 sm:mx-4 rounded-xl shadow-2xl border-0 max-h-[85vh] overflow-y-auto backdrop-blur-sm",children:[e.jsxs(V,{className:"space-y-1 sm:space-y-2 pb-3 sm:pb-4",children:[e.jsxs(G,{className:"flex items-center text-lg sm:text-xl font-bold text-[#1B5AAB]",children:[e.jsx(L,{className:"w-5 h-5 sm:w-6 sm:h-6 mr-2",style:{color:"#1B5AAB"}}),"Nuovo Indirizzo"]}),e.jsx(X,{className:"text-gray-600 text-xs sm:text-sm leading-relaxed",children:"Aggiungi un nuovo indirizzo per le tue consegne future."})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3 pt-2",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"newTitle",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Titolo (es. Casa, Ufficio)"}),e.jsx(x,{id:"newTitle",name:"title",value:n.title,onChange:oe,placeholder:"Casa",className:"h-8 sm:h-9 border border-[#1B5AAB] rounded-md focus:border-[#1B5AAB] focus:ring-1 focus:ring-[#1B5AAB]/20 transition-all duration-200 text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-xs sm:text-sm"})]}),e.jsx("div",{children:e.jsx(_e,{label:"Indirizzo",placeholder:"Inizia a digitare l'indirizzo...",value:n.address,onChange:s=>{v({...n,address:s})},onAddressSelect:s=>{v({...n,address:s.address,city:s.city,province:s.province,postalCode:s.postalCode})},className:"text-xs sm:text-sm",required:!0})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"newCity",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Città *"}),e.jsx(x,{id:"newCity",name:"city",value:n.city,onChange:oe,placeholder:"Città",className:"h-8 sm:h-9 border border-[#1B5AAB] rounded-md focus:border-[#1B5AAB] focus:ring-1 focus:ring-[#1B5AAB]/20 transition-all duration-200 text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-xs sm:text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"newProvince",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Provincia *"}),e.jsx(x,{id:"newProvince",name:"province",value:n.province,onChange:oe,placeholder:"BA",className:"h-8 sm:h-9 border border-[#1B5AAB] rounded-md focus:border-[#1B5AAB] focus:ring-1 focus:ring-[#1B5AAB]/20 transition-all duration-200 text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-xs sm:text-sm",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"newPostalCode",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"CAP *"}),e.jsx(x,{id:"newPostalCode",name:"postalCode",value:n.postalCode,onChange:oe,placeholder:"70019",className:"h-8 sm:h-9 border border-[#1B5AAB] rounded-md focus:border-[#1B5AAB] focus:ring-1 focus:ring-[#1B5AAB]/20 transition-all duration-200 text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-xs sm:text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Paese"}),e.jsx(x,{value:"Italia",className:"h-8 sm:h-9 border border-gray-300 rounded-md bg-gray-50 text-gray-600 cursor-not-allowed text-xs sm:text-sm",readOnly:!0})]})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 pt-4 sm:pt-6",children:[e.jsx(y,{variant:"outline",onClick:()=>{T(!1),v({title:"",address:"",city:"",province:"",postalCode:"",notes:""})},className:"flex-1 h-8 sm:h-9 border border-[#1B5AAB] text-[#1B5AAB] hover:bg-[#1B5AAB] hover:text-white rounded-md font-medium transition-all duration-200 text-xs sm:text-sm",children:"Annulla"}),e.jsx(y,{onClick:De,className:"flex-1 h-8 sm:h-9 bg-[#1B5AAB] hover:bg-[#164a94] text-white rounded-md font-medium transition-all duration-200 shadow-sm hover:shadow-md text-xs sm:text-sm",children:"Salva Indirizzo"})]})]})]})}),e.jsx(K,{open:ne,onOpenChange:q,children:e.jsxs(Q,{className:"max-w-sm mx-2 sm:mx-4 rounded-xl shadow-2xl border-0 max-h-[85vh] overflow-y-auto",children:[e.jsxs(V,{className:"space-y-1 pb-2",children:[e.jsxs(G,{className:"flex items-center text-lg sm:text-xl font-bold text-gray-800",children:[e.jsx(L,{className:"w-5 h-5 sm:w-6 sm:h-6 mr-2",style:{color:"#1B5AAB"}}),"Modifica Indirizzo"]}),e.jsx(X,{className:"text-gray-600 text-sm sm:text-base leading-relaxed",children:"Modifica i dettagli del tuo indirizzo."})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"editTitle",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Titolo (es. Casa, Ufficio)"}),e.jsx(x,{id:"editTitle",name:"title",value:n.title,onChange:s=>v(a=>({...a,title:s.target.value})),placeholder:"Casa",className:"h-8 sm:h-9 focus:ring-[#1B5AAB] rounded-md text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-sm border-gray-300 focus:border-[#1B5AAB]"})]}),e.jsx("div",{children:e.jsx(_e,{label:"Indirizzo",placeholder:"Inizia a digitare l'indirizzo...",value:n.address,onChange:s=>{v({...n,address:s})},onAddressSelect:s=>{v({...n,address:s.address,city:s.city,province:s.province,postalCode:s.postalCode})},required:!0,focusTargetId:"save-address-button"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"editCity",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Città *"}),e.jsx(x,{id:"editCity",name:"city",value:n.city,onChange:s=>v(a=>({...a,city:s.target.value})),placeholder:"Inserisci la Città",className:"h-8 sm:h-9 focus:ring-[#1B5AAB] rounded-md text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-sm border-gray-300 focus:border-[#1B5AAB]",required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"editProvince",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Provincia *"}),e.jsx(x,{id:"editProvince",name:"province",value:n.province,onChange:s=>v(a=>({...a,province:s.target.value})),placeholder:"Inserisci la Provincia",className:"h-8 sm:h-9 focus:ring-[#1B5AAB] rounded-md text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-sm border-gray-300 focus:border-[#1B5AAB]",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"editPostalCode",className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"CAP *"}),e.jsx(x,{id:"editPostalCode",name:"postalCode",value:n.postalCode,onChange:s=>v(a=>({...a,postalCode:s.target.value})),placeholder:"Inserisci il Cap",className:"h-8 sm:h-9 focus:ring-[#1B5AAB] rounded-md text-[#1B5AAB] placeholder:text-[#1B5AAB]/60 selection:bg-[#1B5AAB]/20 text-sm border-gray-300 focus:border-[#1B5AAB]",required:!0})]}),e.jsxs("div",{children:[e.jsx(h,{className:"text-xs sm:text-sm font-semibold text-[#1B5AAB] mb-1 block",children:"Paese"}),e.jsx(x,{value:"IT",className:"h-8 sm:h-9 bg-gray-50 border-gray-200 text-gray-500 rounded-md text-sm",readOnly:!0})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(y,{variant:"outline",onClick:()=>{q(!1),w(null),v({title:"",address:"",city:"",province:"",postalCode:"",notes:""})},className:"flex-1 h-8 sm:h-9 border-2 border-gray-300 text-gray-700 hover:bg-[#A40800] hover:text-white hover:border-[#A40800] transition-all duration-200 rounded-md font-medium text-sm",children:"Annulla"}),e.jsx(y,{onClick:async()=>{if(!n.address||!n.city||!n.province||!n.postalCode){g.error("Compila tutti i campi obbligatori");return}ve(!0);try{const s=await de({address:n.address,city:n.city,province:n.province,postalCode:n.postalCode}),a=Y({city:n.city,province:n.province,postalCode:n.postalCode,coordinates:s?{lat:s.lat,lng:s.lng}:void 0}),r={title:n.title||(F==null?void 0:F.title),address:n.address,city:n.city,province:n.province,postalCode:n.postalCode,notes:n.notes,coordinates:s?{lat:s.lat,lng:s.lng}:void 0,deliveryZone:a?{id:a.id,name:a.name,color:a.color}:null},d=f.map(t=>t.id===(F==null?void 0:F.id)?{...t,...r}:t);if(l&&i.isAuthenticated)try{const t=d.map(p=>({id:p.id,title:p.title||"",address:p.address||"",city:p.city||"",province:p.province||"",postalCode:p.postalCode||"",notes:p.notes||"",coordinates:p.coordinates||null,deliveryZone:p.deliveryZone||null})),S=((l==null?void 0:l.meta_data)||[]).filter(p=>p.key!=="saved_addresses"),O=JSON.stringify(t);JSON.parse(O),S.push({key:"saved_addresses",value:O}),await R.mutateAsync({id:l.id,customerData:{meta_data:S}})}catch(t){console.error("Errore nella serializzazione degli indirizzi:",t),g.error("Errore nel salvataggio dell'indirizzo");return}A(d),q(!1),w(null),a?g.success(`Indirizzo aggiornato e assegnato alla ${a.name}`):g.success("Indirizzo modificato con successo!")}catch(s){console.error("Errore nel salvataggio:",s),g.error("Errore nel salvataggio dell'indirizzo")}finally{ve(!1)}},id:"save-address-button",disabled:je,className:"flex-1 h-8 sm:h-9 bg-[#1B5AAB] hover:bg-[#164a94] text-white disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 rounded-md font-medium shadow-lg hover:shadow-xl text-sm",children:je?e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(ee,{className:"w-3 h-3 sm:w-4 sm:h-4 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Salvando..."}),e.jsx("span",{className:"sm:hidden",children:"..."})]}):"Salva Modifiche"})]})]})})]})};export{Os as default};
