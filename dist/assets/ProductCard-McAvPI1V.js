import{j as t,y as j,v,z as w,B as N,E as C}from"./ui-vendor-CBu0MraC.js";import{a as k}from"./react-vendor-DTdTrAaS.js";import{B as x}from"./input-BrCX-FV-.js";import{a as A,g as a,b as h,J as r}from"./index-I5fS8uHh.js";import{L as d}from"./router-vendor-C3VyKldT.js";const T=({product:e})=>{const{state:y,dispatch:l}=A(),[b,g]=k.useState(!1),o=e.stock_status==="instock"||e.inStock!==!1,n=y.items.find(s=>s.id===e.id),c=!!n,i=(n==null?void 0:n.quantity)||0,m=e.originalPrice&&e.originalPrice>e.price?Math.round((e.originalPrice-e.price)/e.originalPrice*100):0,f=()=>{if(!o){r.error("Prodotto non disponibile");return}l({type:"ADD_ITEM",payload:{id:e.id,name:e.name,price:e.price,image:e.image,category:e.category}}),r.success(`${e.name} aggiunto al carrello!`,{icon:t.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:a(e.category)},children:"✓"}),style:{border:`2px solid ${a(e.category)}`}})},p=()=>{if(!o)return;l({type:"ADD_ITEM",payload:{id:e.id,name:e.name,price:e.price,image:e.image,category:e.category}});const s=c?`Quantità aggiornata: ${i+1}x ${e.name}`:`${e.name} aggiunto al carrello!`;r.success(s,{icon:t.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:a(e.category)},children:"✓"}),style:{border:`2px solid ${a(e.category)}`}})},u=()=>{i>1?(l({type:"UPDATE_QUANTITY",payload:{id:e.id,quantity:i-1}}),r.success(`Quantità aggiornata: ${i-1}x ${e.name}`,{icon:t.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:a(e.category)},children:"✓"}),style:{border:`2px solid ${a(e.category)}`}})):(l({type:"REMOVE_ITEM",payload:e.id}),r.success(`${e.name} rimosso dal carrello`,{icon:t.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:"#A11E26"},children:"✓"}),style:{border:"2px solid #A11E26",backgroundColor:"#A11E26",color:"white"}}))};return t.jsxs("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 group relative overflow-hidden border-2",style:{borderColor:a(e.category)},onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:[m>0&&t.jsxs("div",{className:"absolute top-1 left-1 bg-red-500 text-white px-1.5 py-0.5 rounded text-xs font-bold z-10",children:["-",m,"%"]}),(e.bottleQuantity||h(e.short_description||e.description))&&t.jsxs("div",{className:"absolute top-2 -right-8 text-white px-8 py-1 text-xs font-bold z-10 flex items-center gap-1 transform rotate-45",style:{backgroundColor:a(e.category)},children:["x",e.bottleQuantity||h(e.short_description||e.description)," bott."]}),c&&!b&&t.jsxs("div",{className:"absolute bottom-12 sm:bottom-20 left-1/2 -translate-x-1/2 text-white px-1.5 py-0.5 rounded text-xs font-bold z-10 flex items-center gap-1 whitespace-nowrap",style:{backgroundColor:"#A40800"},children:[t.jsx(j,{className:"w-3 h-3"}),"Nel carrello (",i,")"]}),t.jsxs("div",{className:"relative h-40 sm:h-48 md:h-56 overflow-hidden bg-gray-50",children:[t.jsx(d,{to:`/product/${e.id}`,children:t.jsx("img",{src:e.image,alt:e.name,className:"w-full h-full object-contain group-hover:scale-105 transition-transform duration-300 p-2",onError:s=>{s.currentTarget.src="/placeholder.svg"}})}),t.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 flex flex-col items-center justify-center gap-3 sm:gap-2",children:[c?t.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-4 group-hover:translate-y-0 flex items-center gap-2",children:[t.jsx(x,{onClick:u,className:"text-white px-2 py-1 text-xs bg-red-600 hover:bg-red-700 min-w-[32px] h-8",children:t.jsx(w,{className:"w-3 h-3"})}),t.jsx("span",{className:"text-white font-bold text-sm bg-black bg-opacity-50 px-3 py-1 rounded min-w-[40px] text-center",children:i}),t.jsx(x,{onClick:p,disabled:!o,className:"text-white px-2 py-1 text-xs bg-green-600 hover:bg-green-700 min-w-[32px] h-8",children:t.jsx(N,{className:"w-3 h-3"})})]}):t.jsxs(x,{onClick:f,disabled:!o,className:"opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-4 group-hover:translate-y-0 text-white px-2 py-1 text-xs bg-gray-800 hover:bg-gray-900",children:[t.jsx(v,{className:"w-3 h-3 mr-1"}),o?"Aggiungi":"Non Disponibile"]}),c&&t.jsx(d,{to:"/cart",children:t.jsxs(x,{className:"opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-4 group-hover:translate-y-0 text-white px-2 py-1 text-xs",style:{backgroundColor:"#1B5AAB"},onMouseEnter:s=>s.currentTarget.style.backgroundColor="#154a9a",onMouseLeave:s=>s.currentTarget.style.backgroundColor="#1B5AAB",children:[t.jsx(C,{className:"w-3 h-3 mr-1"}),"Vai al Carrello"]})})]})]}),t.jsxs("div",{className:"p-2",children:[t.jsx(d,{to:`/product/${e.id}`,children:t.jsx("h3",{className:"font-bold mb-1 text-xs sm:text-sm line-clamp-2 hover:opacity-80 transition-colors",style:{color:"#1B5AAB"},children:e.name})}),t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex flex-col",children:[e.originalPrice&&t.jsxs("span",{className:"text-xs text-gray-500 line-through",children:[e.originalPrice.toFixed(2),"€"]}),t.jsxs("span",{className:"font-bold text-sm",style:{color:"#A40800"},children:[e.price.toFixed(2),"€"]})]})})]})]})};export{T as P};
